{
  "hash": "ffd3b0ddf47c3f2e73a5f301e7726469",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"最大似然估计理论\"\nauthor: \"李老师\"\nformat: html\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(haven)\ndata011=read_dta(\"data/lin_1992.dta\")\nlibrary(plm)\npdata11 <- pdata.frame(data011, index = c(\"province\", \"year\"))# 声明为面板数据\n\n# 1. 混合效应模型\npooled <- plm( ltvfo~ltlan+ltwlab+ltpow+ltfer+hrs+mipric1+giprice+mci+ngca\n, data = pdata11, model = \"pooling\")\nsummary(pooled)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPooling Model\n\nCall:\nplm(formula = ltvfo ~ ltlan + ltwlab + ltpow + ltfer + hrs + \n    mipric1 + giprice + mci + ngca, data = pdata11, model = \"pooling\")\n\nBalanced Panel: n = 28, T = 17, N = 476\n\nResiduals:\n      Min.    1st Qu.     Median    3rd Qu.       Max. \n-0.7824480 -0.1278870  0.0061966  0.1280153  0.6244181 \n\nCoefficients:\n             Estimate Std. Error t-value  Pr(>|t|)    \n(Intercept)  1.080587   0.283258  3.8149 0.0001546 ***\nltlan        0.693795   0.036891 18.8064 < 2.2e-16 ***\nltwlab       0.265022   0.023841 11.1165 < 2.2e-16 ***\nltpow       -0.029188   0.033189 -0.8795 0.3796066    \nltfer        0.311062   0.020646 15.0665 < 2.2e-16 ***\nhrs          0.228693   0.030712  7.4463 4.682e-13 ***\nmipric1      0.012205   0.053386  0.2286 0.8192698    \ngiprice     -0.053889   0.027200 -1.9812 0.0481531 *  \nmci          0.694920   0.052242 13.3021 < 2.2e-16 ***\nngca         0.305306   0.195273  1.5635 0.1186188    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nTotal Sum of Squares:    137.42\nResidual Sum of Squares: 18.065\nR-Squared:      0.86854\nAdj. R-Squared: 0.866\nF-statistic: 342.093 on 9 and 466 DF, p-value: < 2.22e-16\n```\n\n\n:::\n\n```{.r .cell-code}\n# 2. 固定效应模型 (within estimator)\nfe <- plm(ltvfo~ltlan+ltwlab+ltpow+ltfer+hrs+mipric1+giprice+mci+ngca\n, data = pdata11, model = \"within\")\nsummary(fe) # 看系数\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOneway (individual) effect Within Model\n\nCall:\nplm(formula = ltvfo ~ ltlan + ltwlab + ltpow + ltfer + hrs + \n    mipric1 + giprice + mci + ngca, data = pdata11, model = \"within\")\n\nBalanced Panel: n = 28, T = 17, N = 476\n\nResiduals:\n      Min.    1st Qu.     Median    3rd Qu.       Max. \n-0.7362863 -0.0527550  0.0057941  0.0572867  0.3795245 \n\nCoefficients:\n         Estimate Std. Error t-value  Pr(>|t|)    \nltlan    0.637023   0.067319  9.4627 < 2.2e-16 ***\nltwlab   0.138779   0.026155  5.3059 1.782e-07 ***\nltpow    0.057715   0.033251  1.7358 0.0833086 .  \nltfer    0.182628   0.021992  8.3043 1.257e-15 ***\nhrs      0.213402   0.022389  9.5317 < 2.2e-16 ***\nmipric1  0.054358   0.042166  1.2891 0.1980288    \ngiprice -0.015145   0.018746 -0.8079 0.4195733    \nmci      0.194370   0.087688  2.2166 0.0271626 *  \nngca     0.756203   0.216814  3.4878 0.0005361 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nTotal Sum of Squares:    39.255\nResidual Sum of Squares: 4.9226\nR-Squared:      0.8746\nAdj. R-Squared: 0.86432\nF-statistic: 340.198 on 9 and 439 DF, p-value: < 2.22e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nfixef(fe)   # 查看每个公司的个体固定效应\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     1      2      3      4      5      6      7      8      9     10     11 \n2.5682 2.3865 2.6198 1.7516 2.5577 2.3377 2.3331 2.2758 2.4271 2.4777 2.6800 \n    12     13     14     15     16     17     18     19     20     21     22 \n2.5308 2.6833 2.4329 2.3461 2.2892 1.6393 1.6868 1.8619 2.2339 2.5632 2.6821 \n    23     24     25     26     27     28 \n2.0369 2.5933 2.2634 2.1674 2.2907 2.7446 \n```\n\n\n:::\n\n```{.r .cell-code}\n# 3. 随机效应模型\nre <- plm(ltvfo~ltlan+ltwlab+ltpow+ltfer+hrs+mipric1+giprice+mci+ngca\n, data = pdata11, model = \"random\")\nsummary(re)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOneway (individual) effect Random Effect Model \n   (Swamy-Arora's transformation)\n\nCall:\nplm(formula = ltvfo ~ ltlan + ltwlab + ltpow + ltfer + hrs + \n    mipric1 + giprice + mci + ngca, data = pdata11, model = \"random\")\n\nBalanced Panel: n = 28, T = 17, N = 476\n\nEffects:\n                  var std.dev share\nidiosyncratic 0.01121 0.10589 0.387\nindividual    0.01776 0.13327 0.613\ntheta: 0.8108\n\nResiduals:\n      Min.    1st Qu.     Median    3rd Qu.       Max. \n-0.7625559 -0.0578594  0.0063645  0.0616459  0.3477979 \n\nCoefficients:\n             Estimate Std. Error z-value  Pr(>|z|)    \n(Intercept)  2.480645   0.341489  7.2642 3.752e-13 ***\nltlan        0.552368   0.051812 10.6611 < 2.2e-16 ***\nltwlab       0.155434   0.024230  6.4150 1.408e-10 ***\nltpow        0.054219   0.033165  1.6348  0.102081    \nltfer        0.194643   0.021463  9.0686 < 2.2e-16 ***\nhrs          0.221219   0.022601  9.7879 < 2.2e-16 ***\nmipric1      0.025669   0.042209  0.6081  0.543101    \ngiprice     -0.019608   0.019003 -1.0319  0.302135    \nmci          0.437277   0.067377  6.4900 8.585e-11 ***\nngca         0.669177   0.211996  3.1566  0.001596 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nTotal Sum of Squares:    42.771\nResidual Sum of Squares: 5.7644\nR-Squared:      0.86523\nAdj. R-Squared: 0.86262\nChisq: 2991.63 on 9 DF, p-value: < 2.22e-16\n```\n\n\n:::\n\n```{.r .cell-code}\n# ---------- 模型选择检验 ----------\n# 检验1：混合 vs. 固定 (F检验) - 是否存在个体效应？\npooltest(pooled, fe) # 若p<0.05，拒绝原假设，选择固定效应\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF statistic\n\ndata:  ltvfo ~ ltlan + ltwlab + ltpow + ltfer + hrs + mipric1 + giprice +  ...\nF = 43.41, df1 = 27, df2 = 439, p-value < 2.2e-16\nalternative hypothesis: unstability\n```\n\n\n:::\n\n```{.r .cell-code}\n# 检验2：固定 vs. 随机 (Hausman检验) - 个体效应是否与解释变量相关？\nphtest(fe, re) # 若p<0.05，拒绝原假设，选择固定效应\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tHausman Test\n\ndata:  ltvfo ~ ltlan + ltwlab + ltpow + ltfer + hrs + mipric1 + giprice +  ...\nchisq = 39.626, df = 9, p-value = 8.88e-06\nalternative hypothesis: one model is inconsistent\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(fixest)\n\n# 固定效应模型 - 语法极其简洁\nfe_fixest <- feols(ltvfo~ltlan+ltwlab+ltpow+ltfer+hrs+mipric1+giprice+mci+ngca | province, data = pdata11)\nsummary(fe_fixest)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOLS estimation, Dep. Var.: ltvfo\nObservations: 476\nFixed-effects: province: 28\nStandard-errors: IID \n         Estimate Std. Error   t value   Pr(>|t|)    \nltlan    0.637023   0.067319  9.462743  < 2.2e-16 ***\nltwlab   0.138779   0.026155  5.305923 1.7822e-07 ***\nltpow    0.057715   0.033251  1.735756 8.3309e-02 .  \nltfer    0.182628   0.021992  8.304275 1.2567e-15 ***\nhrs      0.213402   0.022389  9.531743  < 2.2e-16 ***\nmipric1  0.054358   0.042166  1.289138 1.9803e-01    \ngiprice -0.015145   0.018746 -0.807921 4.1957e-01    \nmci      0.194370   0.087688  2.216595 2.7163e-02 *  \nngca     0.756203   0.216814  3.487794 5.3614e-04 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nRMSE: 0.101694     Adj. R2: 0.961241\n                 Within R2: 0.874599\n```\n\n\n:::\n\n```{.r .cell-code}\n# 固定效应模型 - 稳健标准误\nfe_fixest_robust <- feols(ltvfo~ltlan+ltwlab+ltpow+ltfer+hrs+mipric1+giprice+mci+ngca | province, data = pdata11,cluster = ~province)\nsummary(fe_fixest_robust)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOLS estimation, Dep. Var.: ltvfo\nObservations: 476\nFixed-effects: province: 28\nStandard-errors: Clustered (province) \n         Estimate Std. Error   t value   Pr(>|t|)    \nltlan    0.637023   0.168133  3.788796 7.7174e-04 ***\nltwlab   0.138779   0.062459  2.221931 3.4859e-02 *  \nltpow    0.057715   0.075557  0.763865 4.5157e-01    \nltfer    0.182628   0.043592  4.189483 2.6763e-04 ***\nhrs      0.213402   0.039110  5.456404 8.9588e-06 ***\nmipric1  0.054358   0.059033  0.920801 3.6531e-01    \ngiprice -0.015145   0.024597 -0.615734 5.4323e-01    \nmci      0.194370   0.077051  2.522595 1.7849e-02 *  \nngca     0.756203   0.382126  1.978936 5.8106e-02 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nRMSE: 0.101694     Adj. R2: 0.961241\n                 Within R2: 0.874599\n```\n\n\n:::\n\n```{.r .cell-code}\n# 添加双维固定效应（公司和年份）\nfe_twoway <- feols(ltvfo~ltlan+ltwlab+ltpow+ltfer+hrs+mipric1+giprice+mci+ngca | province + year, data = pdata11)\nsummary(fe_twoway)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOLS estimation, Dep. Var.: ltvfo\nObservations: 476\nFixed-effects: province: 28,  year: 17\nStandard-errors: IID \n       Estimate Std. Error t value   Pr(>|t|)    \nltlan  0.583359   0.066837 8.72814  < 2.2e-16 ***\nltwlab 0.151491   0.025618 5.91339 6.8932e-09 ***\nltpow  0.097111   0.039656 2.44882 1.4736e-02 *  \nltfer  0.169335   0.021671 7.81390 4.3931e-14 ***\nhrs    0.150375   0.050077 3.00287 2.8324e-03 ** \nmci    0.197837   0.083418 2.37165 1.8154e-02 *  \nngca   0.778408   0.221906 3.50783 4.9995e-04 ***\n... 2 variables were removed because of collinearity (mipric1 and\ngiprice)\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nRMSE: 0.093835     Adj. R2: 0.965913\n                 Within R2: 0.675136\n```\n\n\n:::\n\n```{.r .cell-code}\n# 随机效应模型 - 使用lme4框架，然后与fe比较\nlibrary(lme4)\nre_lmer <- lmer(ltvfo~ltlan+ltwlab+ltpow+ltfer+hrs+mipric1+giprice+mci+ngca + (1 | province), data = pdata11)\nsummary(re_lmer)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: ltvfo ~ ltlan + ltwlab + ltpow + ltfer + hrs + mipric1 + giprice +  \n    mci + ngca + (1 | province)\n   Data: pdata11\n\nREML criterion at convergence: -618.2\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-7.2637 -0.4955  0.0453  0.5278  3.1792 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n province (Intercept) 0.05101  0.2259  \n Residual             0.01135  0.1065  \nNumber of obs: 476, groups:  province, 28\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)  2.55226    0.35678   7.154\nltlan        0.55597    0.05623   9.887\nltwlab       0.15320    0.02469   6.206\nltpow        0.05969    0.03276   1.822\nltfer        0.18234    0.02138   8.530\nhrs          0.21926    0.02214   9.902\nmipric1      0.03883    0.04161   0.933\ngiprice     -0.01574    0.01859  -0.847\nmci          0.35847    0.07290   4.918\nngca         0.70650    0.21192   3.334\n\nCorrelation of Fixed Effects:\n        (Intr) ltlan  ltwlab ltpow  ltfer  hrs    miprc1 gipric mci   \nltlan   -0.933                                                        \nltwlab   0.482 -0.636                                                 \nltpow    0.564 -0.582  0.252                                          \nltfer   -0.035  0.184 -0.233 -0.436                                   \nhrs     -0.444  0.457 -0.187 -0.562 -0.057                            \nmipric1 -0.388  0.254  0.084 -0.637 -0.116  0.303                     \ngiprice -0.485  0.351 -0.180 -0.455 -0.257  0.212  0.547              \nmci     -0.544  0.413 -0.437 -0.030 -0.096  0.305 -0.141  0.150       \nngca    -0.119  0.124 -0.037 -0.152 -0.030 -0.158  0.009  0.038 -0.217\n```\n\n\n:::\n\n```{.r .cell-code}\n# 注意：fixest本身不直接做RE，但可配合lme4和后续检验\n```\n:::\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}