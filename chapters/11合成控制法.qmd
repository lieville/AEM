---
title: "11 合成控制法"
format: html
---

## 本章导读

合成控制法是一种专门用于政策评估和因果推断的计量经济学方法，特别适用于评估某一政策或事件对**单一**处理单元（如一个国家、一个省份、一个城市）的影响。其核心思想是为处理单元构造一个"合成对照组"——即由未受处理的多个控制单元的加权组合，使其在处理前的结果变量路径与真实处理单元尽可能相似。本章将系统阐述SCM的基本原理、权重构造、有效性检验、统计推断方法及前沿进展，帮助读者掌握这一在小样本、少处理组情境下的重要因果推断工具。

## 11.1 为何需要合成控制法？单一个案评估的挑战

### 11.1.1 传统方法的局限：DID与匹配方法在少处理组时的困境

在政策评估中，当处理组数量极少（甚至只有一个）时，传统方法面临严峻挑战：

**双重差分法的局限**： DID要求处理组和对照组满足平行趋势假设，且通常需要较多的处理组和对照组单元进行统计推断。当只有一个处理单元时： 1. 难以找到合适的对照组 2. 无法进行有效的统计推断（标准误计算困难） 3. 平行趋势假设难以检验

**倾向得分匹配的局限**： PSM需要足够多的控制单元进行匹配，当处理单元极少时： 1. 匹配质量难以保证 2. 共同支持域可能很小 3. 统计推断不可靠

**简单比较的局限**： 直接比较处理单元与某个特定控制单元，容易受到特殊因素的影响，缺乏反事实构造的科学性。

### 11.1.2 Abadie与Gardeazabal（2003）的奠基性研究

合成控制法的开创性工作来自Abadie和Gardeazabal（2003），他们研究了西班牙巴斯克地区的恐怖主义活动对经济增长的影响。

**研究背景**： - 处理单元：巴斯克地区（受恐怖主义影响） - 控制单元：西班牙其他地区 - 政策/事件：持续的恐怖主义活动 - 时期：1955-1997年

**方法创新**： 1. 使用加权组合构造"合成巴斯克" 2. 权重选择使合成巴斯克在处理前（恐怖主义活动开始前）的经济特征与真实巴斯克尽可能相似 3. 比较真实巴斯克与合成巴斯克在处理后的经济增长路径

**研究结论**： 恐怖主义活动导致巴斯克地区人均GDP下降了约10个百分点。

### 11.1.3 SCM的核心优势：透明性、数据驱动与避免外推

合成控制法相对于传统方法的优势：

**透明性**： 权重向量明确显示每个控制单元的贡献，使得反事实的构造过程完全透明。

**数据驱动**： 权重通过优化算法确定，最小化处理前的预测误差，减少了主观选择偏差。

**避免外推**： 合成控制法通常要求权重非负且和为1，这意味着合成控制单元是控制单元的凸组合，从而避免外推到数据范围之外。

**适合小样本**： 特别适用于处理单元极少的情况，甚至只有一个处理单元。

## 11.2 合成控制法的基本原理与模型设定

### 11.2.1 潜在结果框架与反事实构造问题

设我们有$J+1$个地区（单元），其中第一个地区（$j=1$）在时期$T_0$受到政策干预，其余$J$个地区（$j=2,\dots,J+1$）未受干预。观测时期为$t=1,2,\dots,T$，其中$T_0$是政策实施时点。

**潜在结果框架**： 令$Y_{jt}^N$表示地区$j$在时期$t$未受干预的潜在结果，$Y_{jt}^I$表示受干预的潜在结果。实际观测结果为：

$$
Y_{jt} = 
\begin{cases}
Y_{jt}^N & \text{if } t \leq T_0 \text{ 或 } j \neq 1 \\
Y_{jt}^I & \text{if } t > T_0 \text{ 且 } j = 1
\end{cases}
$$

**因果效应**： 处理地区$j=1$在时期$t>T_0$的处理效应为：

$$
\tau_{1t} = Y_{1t}^I - Y_{1t}^N
$$

问题在于$Y_{1t}^N$（反事实结果）无法观测。合成控制法的目标是构造一个反事实估计$\hat{Y}_{1t}^N$。

### 11.2.2 数据结构：处理前多期结果变量与协变量

合成控制法利用两类信息：

**结果变量**： $Y_{jt}$：地区$j$在时期$t$的实际观测结果。我们特别关注处理前时期（$t=1,\dots,T_0$）的结果变量。

**协变量**： $X_j = (X_{j1}, X_{j2}, \dots, X_{jk})'$：地区$j$的$k$个预处理特征，这些特征应该与结果变量相关且不受政策影响。

**数据结构要求**： 1. 处理前时期足够长（$T_0$足够大） 2. 控制单元足够多且与处理单元相关 3. 协变量包含影响结果的重要变量

### 11.2.3 权重向量的构造：最小化处理前预测误差

合成控制法的核心是找到权重向量$W = (w_2, w_3, \dots, w_{J+1})'$，其中$w_j \geq 0$且$\sum_{j=2}^{J+1} w_j = 1$，使得合成控制单元在处理前的特征与处理单元尽可能相似。

**目标**： 1. 协变量平衡：合成控制单元的协变量近似等于处理单元的协变量 2. 处理前结果路径相似：合成控制单元在处理前的结果变量路径近似于处理单元

**优化问题**： 选择权重$W$最小化以下距离度量：

$$
\|X_1 - X_0W\|_V = \sqrt{(X_1 - X_0W)'V(X_1 - X_0W)}
$$

其中： - $X_1$是处理单元的协变量向量（$k \times 1$） - $X_0$是控制单元的协变量矩阵（$k \times J$） - $V$是一个$k \times k$的正定对角线矩阵，表示不同协变量的相对重要性

## 11.3 权重的估计与"合成控制单元"的构造

### 11.3.1 目标函数与约束条件

合成控制法的权重通过求解以下约束优化问题得到：

$$
\min_{W} \|X_1 - X_0W\|_V = \sqrt{(X_1 - X_0W)'V(X_1 - X_0W)}
$$

满足： 1. $w_j \geq 0$ 对于所有 $j=2,\dots,J+1$ 2. $\sum_{j=2}^{J+1} w_j = 1$

其中$V$矩阵的选择至关重要。通常$V$是对角矩阵，对角线元素表示每个协变量在距离度量中的相对重要性。

### 11.3.2 数值求解方法

权重估计是一个带约束的二次规划问题，可以使用标准优化算法求解：

**算法步骤**： 1. 初始化权重$W$ 2. 选择权重矩阵$V$ 3. 求解优化问题得到最优权重$W^*$ 4. 计算合成控制结果：$\hat{Y}_{1t}^N = \sum_{j=2}^{J+1} w_j^* Y_{jt}$

$V$矩阵的选择： $V$通常通过以下方法选择： 1. **简单平均**：所有协变量同等重要 2. **基于预测能力**：选择$V$使合成控制单元在处理前的结果变量路径与处理单元最接近 3. **交叉验证**：将处理前时期分为训练期和验证期

在实践中，常用方法是选择$V$最小化处理前时期的预测误差：

$$
\min_V \sum_{t=1}^{T_0} \left(Y_{1t} - \sum_{j=2}^{J+1} w_j^*(V) Y_{jt}\right)^2
$$

这是一个嵌套优化问题：内层优化求解$W^*(V)$，外层优化求解$V$。

### 11.3.3 协变量的作用：平衡处理前特征与趋势

协变量在合成控制法中扮演两个重要角色：

**平衡处理前特征**： 确保合成控制单元在处理前的可观测特征与处理单元相似。

**捕捉处理前趋势**： 通过包含处理前的结果变量（或它们的函数）作为协变量，可以确保合成控制单元在处理前的结果变量路径与处理单元相似。

**常见的协变量处理方式**： 1. 处理前各期的结果变量均值 2. 处理前结果变量的线性趋势 3. 其他与结果变量相关的经济、社会、人口特征 4. 处理前关键时点的结果变量值

**建议**： 包含处理前多期结果变量作为协变量，可以更好地捕捉处理前趋势，提高合成控制的质量。

## 11.4 效应评估、图形展示与安慰剂检验

### 11.4.1 处理效应的计算与图形化（路径对比图）

**处理效应估计**： 在得到最优权重$W^*$后，合成控制单元在处理后时期$t>T_0$的反事实结果为：

$$
\hat{Y}_{1t}^N = \sum_{j=2}^{J+1} w_j^* Y_{jt}
$$

处理效应估计为：

$$
\hat{\tau}_{1t} = Y_{1t} - \hat{Y}_{1t}^N, \quad t > T_0
$$

**平均处理效应**： $$
\hat{\tau} = \frac{1}{T-T_0} \sum_{t=T_0+1}^T \hat{\tau}_{1t}
$$

**图形展示**： 1. **路径对比图**：绘制处理单元和合成控制单元在全部时期的结果变量路径 2. **效应图**：绘制处理效应$\hat{\tau}_{1t}$随时间的变化 3. **权重图**：展示各控制单元的权重，了解合成控制单元的构成

路径对比图是最重要的诊断工具，可以直观展示： - 处理前拟合质量 - 处理后的差异 - 处理效应的动态变化

### 11.4.2 "安慰剂检验"（或"排列检验"）的原理与实施

由于只有一个处理单元，传统的统计推断方法不适用。合成控制法使用安慰剂检验进行推断。

**基本思想**： 如果政策效应是真实的，那么： 1. 处理单元的处理效应应该显著大于控制单元 2. 将处理"虚假地"分配给控制单元时，不应观察到显著效应

**实施步骤**： 1. 将每个控制单元依次视为"伪处理单元" 2. 用其他控制单元为其构造合成控制 3. 计算每个伪处理单元的"伪处理效应" 4. 比较真实处理效应与伪处理效应的分布

**安慰剂效应**： 对于每个控制单元$j=2,\dots,J+1$，假设它在时期$T_0$受到处理，用其他控制单元为其构造合成控制，计算伪处理效应：

$$
\hat{\tau}_{jt}^{placebo} = Y_{jt} - \hat{Y}_{jt}^{N,placebo}, \quad t > T_0
$$

其中$\hat{Y}_{jt}^{N,placebo}$是单元$j$的合成控制结果。

### 11.4.3 显著性推断：p值的计算与解读

通过安慰剂检验可以计算非参数的p值：

**p值计算**： 比较真实处理效应与安慰剂效应的分布。对于每个时期$t>T_0$，计算：

$$
p_t = \frac{\text{安慰剂效应} \geq \text{真实效应}}{\text{安慰剂检验次数} + 1}
$$

更常见的是计算平均处理效应的p值：

$$
p = \frac{\text{平均安慰剂效应} \geq \text{平均真实效应}}{\text{安慰剂检验次数} + 1}
$$

**经验p值**： 如果进行$J$次安慰剂检验（对每个控制单元），则最小可能的p值为$1/(J+1)$。因此，安慰剂检验需要足够多的控制单元才能提供有意义的推断。

**显著性判断**： 如果真实处理效应位于安慰剂效应的极端位置（如最大的5%），则认为处理效应统计显著。

**图形展示**： 1. **安慰剂效应分布图**：绘制所有安慰剂效应和真实效应 2. **p值序列图**：绘制各时期处理效应的p值

## 11.5 合成控制法的扩展与稳健性讨论

### 11.5.1 多个处理单元与推广的合成控制法

当有多个处理单元时，可以推广合成控制法：

**多处理单元SCM**： 1. 为每个处理单元单独构造合成控制 2. 计算每个处理单元的处理效应 3. 汇总处理效应（简单平均或加权平均）

**交互固定效应模型**： 将SCM视为一种特殊的因子模型： $$
Y_{jt}^N = \delta_t + \theta_t Z_j + \lambda_t \mu_j + \epsilon_{jt}
$$ 其中： - $\delta_t$：时间固定效应 - $Z_j$：可观测协变量 - $\lambda_t$：共同因子 - $\mu_j$：因子载荷 - $\epsilon_{jt}$： idiosyncratic冲击

合成控制法相当于用控制单元的加权组合估计$\lambda_t \mu_1$。

### 11.5.2 安慰剂检验的变体与敏感性分析

**安慰剂检验的变体**： 1. **时间安慰剂检验**：将政策时点提前，检验"伪政策"效应 2. **空间安慰剂检验**：使用地理上不相邻的地区作为安慰剂 3. **协变量安慰剂检验**：使用理论上不应受影响的变量作为结果

**敏感性分析**： 1. **控制池变化**：使用不同的控制单元集合 2. **协变量变化**：使用不同的协变量组合 3. **时期变化**：使用不同的处理前时期 4. **权重约束变化**：放松权重非负或和为1的约束

敏感性分析用于检验估计结果对模型设定的稳健性。

### 11.5.3 交叉验证与正则化方法

**交叉验证**： 将处理前时期分为训练期和验证期： 1. 使用训练期估计权重 2. 使用验证期评估预测效果 3. 选择预测误差最小的模型设定

**正则化方法**： 当控制单元较多时，可以引入正则化防止过拟合： 1. **岭回归型正则化**：在目标函数中加入权重平方和惩罚项 2. **LASSO型正则化**：加入权重绝对值和惩罚项，促进稀疏解 3. **弹性网络**：结合岭回归和LASSO的优点

正则化可以帮助提高合成控制法的稳定性和泛化能力。

### 11.5.4 合成控制法与矩阵补全、因子模型的联系

**矩阵补全视角**： SCM可以视为矩阵补全问题：我们有一个结果变量矩阵$Y$，其中某些元素（处理单元在处理后的结果）缺失，目标是根据观测值补全缺失值。

**因子模型视角**： SCM与因子模型密切相关。假设结果数据由因子模型生成： $$
Y_{jt} = \delta_t + \lambda_t \mu_j + \epsilon_{jt}
$$ 其中$\lambda_t$是共同因子，$\mu_j$是因子载荷。合成控制法用控制单元的加权组合估计处理单元的因子载荷组合。

**广义合成控制法**： 将SCM推广到更一般的因子模型设定，允许更灵活的估计和推断。

## 11.6 应用实例与操作指南

### 11.6.1 经典案例回顾：加州烟草控制法案（AB 08）的效果评估

### 11.6.2 Stata (`synth`)、R (`Synth`) 中的实现步骤

### 11.6.3 研究报告的规范：如何展示结果与进行稳健性检验

## 本章总结

合成控制法为评估针对特定地区或个体的政策干预提供了强大的工具，特别适用于处理单元极少的情况。其核心优势在于透明性、数据驱动和避免外推。本章系统介绍了SCM的基本原理、权重估计、效应评估、统计推断方法以及各种扩展和稳健性分析。

然而，合成控制法的有效性依赖于几个关键条件：处理前时期足够长、控制单元池足够大且与处理单元相关、协变量选择恰当。统计推断严重依赖安慰剂检验，因此需要足够多的控制单元才能进行有意义的显著性检验。

在实践中，研究者应： 1. 提供清晰的路径对比图，展示处理前拟合质量 2. 进行充分的安慰剂检验和敏感性分析 3. 透明报告权重向量，说明合成控制单元的构成 4. 谨慎解释结果，考虑可能的替代解释

近年来，合成控制法与计量经济学和机器学习方法的结合进一步拓展了其应用边界，如正则化SCM、广义SCM、矩阵补全方法等。这些发展为小样本政策评估提供了更丰富、更稳健的工具箱。然而，无论方法如何扩展，对数据要求的理解和严格的稳健性检验始终是应用合成控制法的基石。