---
title: "3 面板数据模型"
format: html
editor: visual
---

## 本章导读

面板数据（Panel Data）结合了横截面与时间序列的双重维度，为识别因果关系提供了更丰富的信息。本章在前两章基础上，系统介绍面板数据的基本模型（混合OLS、固定效应、随机效应）、估计方法及模型选择策略。重点理解**组内变异**与**组间变异**的区别，掌握**豪斯曼检验**，并通过案例体会面板数据在政策评估、劳动经济学等领域的应用价值。本章是连接经典横截面分析与现代因果推断的关键桥梁。

## 3.1 面板数据概述

### 3.1.1 面板数据的定义、结构与符号

**面板数据**是指对**同一组个体**（如个人、企业、国家）在**多个时间点**上进行重复观测所得到的数据。记 $i = 1, 2, \dots, N$ 表示个体，$t = 1, 2, \dots, T$ 表示时间，则观测值 $y_{it}$ 表示第 $i$ 个个体在第 $t$ 期的因变量取值，$\mathbf{x}_{it}$ 表示相应的 $k$ 维解释变量向量。

面板数据的基本结构如下表所示：

| 个体\\时间 | $t=1$ | $t=2$ | $\cdots$ | $t=T$ |
|---------------|---------------|---------------|---------------|---------------|
| $i=1$ | $(y_{11}, \mathbf{x}_{11})$ | $(y_{12}, \mathbf{x}_{12})$ | $\cdots$ | $(y_{1T}, \mathbf{x}_{1T})$ |
| $i=2$ | $(y_{21}, \mathbf{x}_{21})$ | $(y_{22}, \mathbf{x}_{22})$ | $\cdots$ | $(y_{2T}, \mathbf{x}_{2T})$ |
| $\vdots$ | $\vdots$ | $\vdots$ | $\ddots$ | $\vdots$ |
| $i=N$ | $(y_{N1}, \mathbf{x}_{N1})$ | $(y_{N2}, \mathbf{x}_{N2})$ | $\cdots$ | $(y_{NT}, \mathbf{x}_{NT})$ |

### 3.1.2 面板数据的优势与挑战

#### 优势

1.  **控制不可观测异质性**：能够控制不随时间变化的**个体固定效应**（如个人能力、企业文化、地理位置），从而缓解**遗漏变量偏误**。
2.  **提供更丰富的变异信息**：既包含个体间的差异（**组间变异**， Between Variation），也包含个体随时间的变化（**组内变异**， Within Variation），有助于识别因果关系。
3.  **提高估计效率**：更多的观测值通常带来更小的标准误。
4.  **研究动态行为**：可以分析个体行为的动态调整过程。

#### 挑战

1.  **测量误差**：变量的测量误差在面板数据中可能导致动态面板偏误。
2.  **样本损耗**：长期追踪调查中，个体可能退出，导致**非平衡面板**（Unbalanced Panel）。
3.  **模型设定复杂性**：需要选择合适的模型（混合、固定、随机效应），并处理可能的序列相关、异方差和截面相关。

### 3.1.3 基本模型设定

面板数据模型的三种基本设定如下：

1.  **混合回归模型（Pooled Model）** 忽略个体差异，假设所有个体遵循相同的数据生成过程。 $$y_{it} = \beta_0 + \mathbf{x}_{it}'\pmb{\beta} + \varepsilon_{it}$$

2.  **固定效应模型（Fixed Effects Model, FE）** 允许每个个体拥有自己的截距项 $\alpha_i$，且 $\alpha_i$ 可能与解释变量相关。 $$y_{it} = \alpha_i + \mathbf{x}_{it}'\pmb{\beta} + \varepsilon_{it}$$

3.  **随机效应模型（Random Effects Model, RE）** 将个体截距 $\alpha_i$ 视为随机变量，且与解释变量不相关。 $$y_{it} = \beta_0 + \mathbf{x}_{it}'\pmb{\beta} + \alpha_i + \varepsilon_{it}$$

其中，$\alpha_i$ 称为**个体效应**（Individual Effect）或**不可观测异质性**（Unobserved Heterogeneity）。

## 3.2 混合最小二乘估计（Pooled OLS）

### 3.2.1 混合OLS的模型形式与经典假设

混合OLS将 $N \times T$ 个观测值视为一个大的独立横截面数据进行回归，完全忽略面板数据结构： $$y_{it} = \beta_0 + \mathbf{x}_{it}'\pmb{\beta} + \varepsilon_{it}$$

其经典假设与横截面OLS相同：

1\. **线性关系与严格外生性**：$E(\varepsilon_{it} | \mathbf{x}_{it}) = 0$。

2\. **随机抽样**：观测值 $\{ (y_{it}, \mathbf{x}_{it}) \}$ 独立同分布。

3\. **无完全共线性**：解释变量矩阵 $\mathbf{X}$ 列满秩。

4\. **同方差性**：$\text{Var}(\varepsilon_{it} | \mathbf{x}_{it}) = \sigma^2$。

5\. **无自相关**：$\text{Cov}(\varepsilon_{it}, \varepsilon_{js} | \mathbf{x}_{it}, \mathbf{x}_{js}) = 0$，除非 $i=j$ 且 $t=s$。

### 3.2.2 混合OLS的适用条件与局限性

**适用条件**： - 个体效应 $\alpha_i$ 与所有解释变量 $\mathbf{x}_{it}$ 均不相关，即 $\text{Cov}(\alpha_i, \mathbf{x}_{it}) = 0$。 - 研究目的仅关注 $\mathbf{x}_{it}$ 的“平均”效应，而非个体异质性效应。

**局限性**： 1. **遗漏变量偏误**：若 $\alpha_i$ 与 $\mathbf{x}_{it}$ 相关，则混合OLS的估计量 $\hat{\pmb{\beta}}_{\text{Pooled}}$ 是有偏且不一致的。 2. **效率损失**：即使假设成立，混合OLS未利用面板数据的结构信息，其标准误可能不是最有效的（除非使用**聚类稳健标准误**进行修正）。

### 3.2.3 与横截面回归的比较

混合OLS本质上是将面板数据“堆叠”后进行横截面回归。与第2章横截面分析相比： - **数据层面**：混合OLS虽然利用了重复观测，但假设不同期的观测相互独立，忽略了个体内的序列相关性。 - **假设层面**：横截面分析无法检验个体效应的存在，而面板数据允许我们通过比较混合、固定、随机效应模型来做出选择。

## 3.3 固定效应模型（Fixed Effects, FE）

### 3.3.1 固定效应的动机：消除不随时间变化的遗漏变量

固定效应模型的核心动机是控制**不随时间变化**的不可观测异质性 $\alpha_i$。模型设定为： $$y_{it} = \alpha_i + \mathbf{x}_{it}'\pmb{\beta} + \varepsilon_{it}$$ 其中 $\alpha_i$ 是待估参数（或通过变换消除），代表个体 $i$ 特有的、不随时间变化的特征。

### 3.3.2 组内估计量（Within Estimator）的推导与性质

为了消除 $\alpha_i$，对每个个体计算时间均值： $$\bar{y}_i = \frac{1}{T}\sum_{t=1}^{T} y_{it}, \quad \bar{\mathbf{x}}_i = \frac{1}{T}\sum_{t=1}^{T} \mathbf{x}_{it}, \quad \bar{\varepsilon}_i = \frac{1}{T}\sum_{t=1}^{T} \varepsilon_{it}$$

将原模型减去其时间均值模型 $\bar{y}_i = \alpha_i + \bar{\mathbf{x}}_i'\pmb{\beta} + \bar{\varepsilon}_i$，得到**组内变换**（Within Transformation）后的模型： $$y_{it} - \bar{y}_i = (\mathbf{x}_{it} - \bar{\mathbf{x}}_i)'\pmb{\beta} + (\varepsilon_{it} - \bar{\varepsilon}_i)$$

记 $\ddot{y}_{it} = y_{it} - \bar{y}_i$，$\ddot{\mathbf{x}}_{it} = \mathbf{x}_{it} - \bar{\mathbf{x}}_i$，则上式简化为： $$\ddot{y}_{it} = \ddot{\mathbf{x}}_{it}'\pmb{\beta} + \ddot{\varepsilon}_{it}$$ 对上述模型进行OLS回归，得到的估计量 $\hat{\pmb{\beta}}_{\text{FE}}$ 称为**组内估计量**。

**估计量性质**： - **一致性**：只要 $E(\ddot{\varepsilon}_{it} | \ddot{\mathbf{x}}_{it}) = 0$（即 $\mathbf{x}_{it}$ 与 $\varepsilon_{it}$ 不相关），FE估计量是一致的。 - **无法估计不随时间变化的变量**：对于常数变量（如性别、种族），$\ddot{\mathbf{x}}_{it} \equiv 0$，其系数无法被识别。

### 3.3.3 虚拟变量法与一阶差分法（FD）的等价性

**虚拟变量法（LSDV）**：在原始模型中为每个个体加入一个虚拟变量（除一个基准个体外）： $$y_{it} = \beta_0 + \sum_{i=2}^{N} \alpha_i D_i + \mathbf{x}_{it}'\pmb{\beta} + \varepsilon_{it}$$ 其中 $D_i$ 为个体虚拟变量。对该模型进行OLS回归，得到的 $\hat{\pmb{\beta}}$ 与组内估计量完全等价。

**一阶差分法（First Difference, FD）**：对相邻两期数据进行差分，以消除 $\alpha_i$： $$\Delta y_{it} = y_{it} - y_{i,t-1} = (\mathbf{x}_{it} - \mathbf{x}_{i,t-1})'\pmb{\beta} + (\varepsilon_{it} - \varepsilon_{i,t-1})$$ - 当 $T=2$ 时，FD估计量与FE估计量**完全等价**。 - 当 $T>2$ 时，两者略有不同。FD假设扰动项 $\varepsilon_{it}$ 无序列相关，否则FE估计量更有效。

### 3.3.4 固定效应模型的假设、优点与缺点

**核心假设**： 1. **严格外生性**：$E(\varepsilon_{it} | \mathbf{x}_{i1}, \dots, \mathbf{x}_{iT}, \alpha_i) = 0$。即任意时期的扰动项 $\varepsilon_{it}$ 与所有时期（过去、现在、未来）的解释变量均不相关。这是一个较强的假设。 2. $\alpha_i$ 与 $\mathbf{x}_{it}$ 可以存在任意形式的相关性（这正是使用FE的动机）。

**优点**： 1. 能有效控制**不随时间变化**的遗漏变量，缓解由此导致的偏误。 2. 无需对 $\alpha_i$ 的分布做任何假设。

**缺点**： 1. 无法估计不随时间变化的变量的效应。 2. 若关注变量 $x_{it}$ 本身随时间变化很小（即组内变异小），则FE估计量的标准误会很大，估计不精确。 3. 不能控制**随时间变化**的遗漏变量。

## 3.4 随机效应模型（Random Effects, RE）

### 3.4.1 随机效应的设定与假设

随机效应模型将个体效应 $\alpha_i$ 视为随机变量，并纳入复合扰动项中： $$y_{it} = \beta_0 + \mathbf{x}_{it}'\pmb{\beta} + u_{it}, \quad u_{it} = \alpha_i + \varepsilon_{it}$$

**核心假设**： 1. $\alpha_i \sim \text{i.i.d.}(0, \sigma_{\alpha}^2)$，且与 $\varepsilon_{it}$ 相互独立。 2. $\varepsilon_{it} \sim \text{i.i.d.}(0, \sigma_{\varepsilon}^2)$。 3. $\alpha_i$ 与所有解释变量 $\mathbf{x}_{it}$ 均不相关，即 $\text{Cov}(\alpha_i, \mathbf{x}_{it}) = 0$。

在此假设下，复合扰动项 $u_{it}$ 的协方差结构为： $$\text{Var}(u_{it}) = \sigma_{\alpha}^2 + \sigma_{\varepsilon}^2$$ $$\text{Cov}(u_{it}, u_{is}) = \sigma_{\alpha}^2, \quad \text{for } t \neq s$$ 即同一个体不同期的扰动项之间存在相关性，相关系数为 $\rho = \sigma_{\alpha}^2 / (\sigma_{\alpha}^2 + \sigma_{\varepsilon}^2)$。

### 3.4.2 广义最小二乘估计（GLS）的原理与实现

由于扰动项存在组内自相关，OLS不再有效。随机效应模型采用**广义最小二乘法（GLS）**进行估计。其核心是对数据进行**准离差变换**（Quasi-demeaning Transformation）： $$y_{it} - \theta \bar{y}_i = (\mathbf{x}_{it} - \theta \bar{\mathbf{x}}_i)'\pmb{\beta} + [(1-\theta)\beta_0 + (u_{it} - \theta \bar{u}_i)]$$ 其中， $$\theta = 1 - \sqrt{\frac{\sigma_{\varepsilon}^2}{\sigma_{\varepsilon}^2 + T \sigma_{\alpha}^2}}$$

-   当 $\theta=0$ 时，等价于混合OLS（$\sigma_{\alpha}^2=0$）。
-   当 $\theta=1$ 时，等价于固定效应变换（$\sigma_{\varepsilon}^2=0$，或 $T \rightarrow \infty$）。
-   通常 $\theta \in (0, 1)$，RE估计量是混合OLS和FE估计量的加权平均。

实际操作中，需先估计 $\sigma_{\varepsilon}^2$ 和 $\sigma_{\alpha}^2$，然后进行GLS估计。现代软件可自动完成此过程。

### 3.4.3 随机效应模型的效率优势与一致性

**效率优势**：当 $\text{Cov}(\alpha_i, \mathbf{x}_{it}) = 0$ 的假设成立时，RE估计量比FE估计量更**有效**（方差更小），因为它同时利用了数据的**组内变异**和**组间变异**。

**一致性条件**：RE估计量的一致性完全依赖于 $\alpha_i$ 与 $\mathbf{x}_{it}$ 不相关的假设。若该假设不成立，则RE估计量是**不一致**的。因此，RE模型的使用必须依赖于理论支持或统计检验。

## 3.5 模型选择：豪斯曼检验（Hausman Test）

### 3.5.1 豪斯曼检验的核心思想

豪斯曼检验用于判断个体效应 $\alpha_i$ 是否与解释变量 $\mathbf{x}_{it}$ 相关，从而在FE和RE模型之间做出统计选择。

**逻辑基础**： - 如果 $H_0: \text{Cov}(\alpha_i, \mathbf{x}_{it}) = 0$ 成立，则**FE和RE估计量都是一致的**，但RE估计量更有效。 - 如果 $H_0$ 不成立，则**FE估计量仍然一致，但RE估计量不一致**。

因此，可以检验两种估计量之间的差异是否显著。若无显著差异，则选择更有效的RE模型；若有显著差异，则说明RE不一致，应选择FE模型。

### 3.5.2 检验统计量的构造、原假设与备择假设

定义两个估计量的差：$\mathbf{d} = \hat{\pmb{\beta}}_{\text{FE}} - \hat{\pmb{\beta}}_{\text{RE}}$。 在 $H_0$ 下，$\text{plim } \mathbf{d} = 0$。豪斯曼证明，其渐近协方差矩阵为： $$\text{Var}(\mathbf{d}) = \text{Var}(\hat{\pmb{\beta}}_{\text{FE}}) - \text{Var}(\hat{\pmb{\beta}}_{\text{RE}})$$

构造的检验统计量为： $$H = \mathbf{d}' [\widehat{\text{Var}}(\hat{\pmb{\beta}}_{\text{FE}}) - \widehat{\text{Var}}(\hat{\pmb{\beta}}_{\text{RE}})]^{-1} \mathbf{d} \stackrel{a}{\sim} \chi^2(k)$$ 其中 $k$ 为 $\pmb{\beta}$ 的维数（不包括常数项）。

-   **原假设 (**$H_0$)：$\text{Cov}(\alpha_i, \mathbf{x}_{it}) = 0$，应选择随机效应模型。
-   **备择假设 (**$H_1$)：$\text{Cov}(\alpha_i, \mathbf{x}_{it}) \neq 0$，应选择固定效应模型。

**决策规则**：给定显著性水平 $\alpha$（如0.05），若 $H > \chi_{\alpha}^2(k)$，则拒绝 $H_0$，选择固定效应模型；否则，选择随机效应模型。

### 3.5.3 实践中的决策流程

1.  **理论先导**：首先根据经济理论或研究背景判断。如果理论上认为个体效应极有可能与解释变量相关（如企业不可观测的管理能力影响其研发投入），则应直接选择FE模型。
2.  **统计检验**：运行FE和RE模型，进行豪斯曼检验。注意，检验要求RE估计量是有效的（在 $H_0$ 下），因此需要使用基于GLS的RE估计结果。
3.  **稳健性报告**：在学术论文中，通常同时报告FE和RE的估计结果，并注明豪斯曼检验的结论，以体现结论的稳健性。

## 3.6 面板数据模型的扩展与高级应用

### 3.6.1 动态面板数据模型：Arellano-Bond GMM估计

当模型包含因变量的滞后项以刻画动态调整过程时，即为动态面板模型： $$y_{it} = \rho y_{i, t-1} + \mathbf{x}_{it}'\pmb{\beta} + \alpha_i + \varepsilon_{it}$$

此时，即使使用FE变换，变换后的扰动项 $\ddot{\varepsilon}_{it}$ 与变换后的滞后因变量 $\ddot{y}_{i, t-1}$ 仍然相关，导致FE估计量有偏且不一致（**尼克尔偏误**， Nickell Bias）。

**Arellano-Bond估计法**的解决思路： 1. 先对原模型进行一阶差分以消除 $\alpha_i$：$\Delta y_{it} = \rho \Delta y_{i, t-1} + \Delta \mathbf{x}_{it}'\pmb{\beta} + \Delta \varepsilon_{it}$。 2. 差分后，$\Delta y_{i, t-1}$ 与 $\Delta \varepsilon_{it}$ 仍相关。但更早的滞后水平 $y_{i, t-2}, y_{i, t-3}, \dots$ 与 $\Delta \varepsilon_{it}$ 不相关，却与 $\Delta y_{i, t-1}$ 相关，因此可以作为**有效的工具变量**。 3. 利用这些滞后变量作为工具变量，进行**广义矩估计（GMM）**，即**差分GMM**。

### 3.6.2 非平衡面板数据的处理方法

非平衡面板指不同个体拥有的时间期数 $T_i$ 不同。对于FE和RE模型： - **固定效应模型**：组内变换依然适用，只需将均值计算改为 $\bar{y}_i = \frac{1}{T_i}\sum_{t \in \mathcal{T}_i} y_{it}$，其中 $\mathcal{T}_i$ 是个体 $i$ 的观测时期集合。 - **随机效应模型**：GLS估计中的变换参数 $\theta_i$ 变为个体特定：$\theta_i = 1 - \sqrt{\frac{\sigma_{\varepsilon}^2}{\sigma_{\varepsilon}^2 + T_i \sigma_{\alpha}^2}}$。

处理时需关注**样本损耗**（Attrition）是否是随机的，若非随机可能导致样本选择偏误。

### 3.6.3 双向固定效应（Two-Way Fixed Effects）

在基础FE模型上，进一步加入**时间固定效应** $\lambda_t$，以控制所有个体共同面临的时间趋势或宏观冲击： $$y_{it} = \alpha_i + \lambda_t + \mathbf{x}_{it}'\pmb{\beta} + \varepsilon_{it}$$

估计方法：可在组内变换的基础上，再对时间均值进行离差变换（即对 $\ddot{y}_{it}$ 和 $\ddot{\mathbf{x}}_{it}$ 做“时间离差”），或直接加入时间虚拟变量进行LSDV回归。双向固定效应模型是政策评估中**双重差分法（DID）** 的标准设定框架。

## 3.7 面板数据在政策评估中的应用

面板数据是实施**双重差分法（Difference-in-Differences, DID）** 的理想载体。基本DID模型设定如下： $$y_{it} = \beta_0 + \beta_1 \text{Post}_t + \beta_2 \text{Treat}_i + \beta_3 (\text{Post}_t \times \text{Treat}_i) + \alpha_i + \lambda_t + \varepsilon_{it}$$

其中： - $\text{Treat}_i$：处理组虚拟变量（个体层面不随时间变化）。 - $\text{Post}_t$：政策后时期虚拟变量（时间层面不随个体变化）。 - $\text{Post}_t \times \text{Treat}_i$：交互项，其系数 $\beta_3$ 是核心估计量，反映了政策处理的**平均处理效应（ATE）**。

在这个设定中，个体固定效应 $\alpha_i$ 吸收了 $\text{Treat}_i$，时间固定效应 $\lambda_t$ 吸收了 $\text{Post}_t$，因此模型常简写为： $$y_{it} = \beta_3 D_{it} + \alpha_i + \lambda_t + \varepsilon_{it}$$ 其中 $D_{it} = \text{Post}_t \times \text{Treat}_i$ 表示个体 $i$ 在时期 $t$ 是否受到政策处理。这清晰地体现了面板数据通过控制不可观测的个体和时点特征来识别因果效应的优势。

## 本章总结

本章系统介绍了面板数据模型的核心内容，旨在利用数据在时间和个体两个维度的变异来更准确地识别经济关系与因果效应。

1.  **面板数据的本质与优势**：面板数据通过追踪同一组个体在不同时间点的信息，使研究者能够控制**不随时间变化的个体异质性**，这是其相对于横截面数据最根本的优势。

2.  **三大基本模型**：

    -   **混合OLS**：忽略面板结构，假设所有观测独立。适用于个体效应与解释变量绝对不相关的理想情况，但通常风险较大。
    -   **固定效应模型**：通过**组内变换**消除个体效应 $\alpha_i$，允许 $\alpha_i$ 与解释变量任意相关。是解决遗漏变量偏误的强有力工具，但无法估计不随时间变化变量的系数。
    -   **随机效应模型**：将个体效应视为随机扰动的一部分，要求 $\alpha_i$ 与解释变量不相关。若假设满足，则估计效率高于FE模型。

3.  **模型选择的关键**：**豪斯曼检验**提供了在FE与RE之间选择的统计依据。其核心是比较两个估计量的一致性。实践中应结合经济理论和统计检验综合判断。

4.  **扩展与应用**：

    -   **动态面板**：当包含滞后因变量时，需使用**Arellano-Bond GMM**等工具变量方法。
    -   **双向固定效应**：同时控制个体和时间效应，是更为稳健的设定。
    -   **政策评估**：面板数据为**双重差分法**提供了天然的实施框架，通过比较处理组和对照组在政策前后的变化来识别因果效应。

5.  **核心思想贯穿始终**：理解**组内变异**与**组间变异**的区别是掌握面板数据模型的钥匙。固定效应模型仅利用组内变异，随机效应模型则同时利用两种变异。选择何种模型，取决于研究者相信个体不可观测特征 $\alpha_i$ 与解释变量 $\mathbf{x}_{it}$ 是否相关，而这最终关系到估计结果的一致性与可靠性。

面板数据模型是现代计量经济学实证分析的基石。掌握本章内容，意味着具备了利用更丰富的数据结构去检验经济理论、评估政策效果的基本能力，为进一步学习更高级的微观计量与因果推断方法奠定了坚实基础。