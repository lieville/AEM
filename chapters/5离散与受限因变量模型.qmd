---
title: "5 离散数据与受限因变量模型"
format: html
editor: visual
---

## 本章导读

在经典计量经济学模型中，因变量通常被假定为连续变量。然而，在经济决策与实证研究中，大量核心变量本质上是**离散的**（如是否购买、选择何种出行方式）或**数值上受到限制**的（如工作时间非负、消费数据在某一区间内聚集）。以这类变量作为被解释变量建立的模型，分别称为**离散选择模型**和**受限因变量模型**。

离散选择模型旨在分析决策者在有限个备选方案中作出选择的概率，其因变量取值为离散的类别。受限因变量模型则处理因数据搜集机制导致观测值不能完全反映总体分布的情形，例如样本截断或数据归并。这两类模型极大地扩展了计量经济学的应用范围，使其能够更贴切地分析微观个体行为，广泛应用于劳动经济学、金融学、卫生经济学及消费行为研究等领域。

本章将系统阐述这些模型的理论基础、估计方法及解释。首先从最简单的二元选择模型出发，逐步扩展到多元选择、排序选择及计数数据模型，最后讨论处理样本选择或数据截断等问题的受限因变量模型。

## 5.1 二元选择模型

### 5.1.1 线性概率模型及其局限

对于因变量 $y_i$ 取值为0或1的二元选择问题，一个直观的起点是采用**线性概率模型**： $$
y_i = \mathbf{x}_i^\top \pmb{\beta} + \varepsilon_i
$$ 其中 $E(y_i | \mathbf{x}_i) = P(y_i=1 | \mathbf{x}_i) = \mathbf{x}_i^\top \pmb{\beta}$。

该模型尽管估计简便，但存在两个主要缺陷： 1. **预测值可能超出概率区间**：线性组合 $\mathbf{x}_i^\top \hat{\pmb{\beta}}$ 的取值可能不在 `[0, 1]` 之间，这与概率的定义相矛盾。 2. **异方差性**：误差项 $\varepsilon_i$ 的方差为 $\text{Var}(\varepsilon_i | \mathbf{x}_i) = (\mathbf{x}_i^\top \pmb{\beta})(1 - \mathbf{x}_i^\top \pmb{\beta})$，必然存在异方差，导致普通最小二乘估计非有效。

这些缺陷促使我们发展出形式更为灵活的非线性概率模型。

### 5.1.2 潜变量框架与非线性设定

二元选择模型通常基于一个连续的**潜变量** $y_i^*$ 来构建： $$
y_i^* = \mathbf{x}_i^\top \pmb{\beta} + u_i, \quad y_i = 
\begin{cases} 
1, & \text{if } y_i^* > 0 \\
0, & \text{if } y_i^* \le 0 
\end{cases}
$$ 其中 $u_i$ 是独立于 $\mathbf{x}_i$ 的随机扰动项，均值为0，方差固定。潜变量 $y_i^*$ 可理解为决策者的“净收益”或“效用差”。

在此框架下，选择概率为： $$
P(y_i = 1 | \mathbf{x}_i) = P(y_i^* > 0 | \mathbf{x}_i) = P(u_i > -\mathbf{x}_i^\top \pmb{\beta} | \mathbf{x}_i) = 1 - F(-\mathbf{x}_i^\top \pmb{\beta})
$$ 其中 $F(\cdot)$ 是 $u_i$ 的累积分布函数。为保证概率值在 `[0, 1]` 之间且模型设定可识别，需对 $F(\cdot)$ 的形式进行假设。

### 5.1.3 Probit 与 Logit 模型

两种最常用的分布假设对应了核心的二元选择模型： \* **Probit模型**：假设 $u_i$ 服从标准正态分布，即 $u_i \sim N(0, 1)$。此时，$P(y_i = 1 | \mathbf{x}_i) = \Phi(\mathbf{x}_i^\top \pmb{\beta})$，其中 $\Phi(\cdot)$ 是标准正态分布的累积分布函数。 \* **Logit模型**：假设 $u_i$ 服从逻辑分布。此时，$P(y_i = 1 | \mathbf{x}_i) = \Lambda(\mathbf{x}_i^\top \pmb{\beta}) = \frac{\exp(\mathbf{x}_i^\top \pmb{\beta})}{1 + \exp(\mathbf{x}_i^\top \pmb{\beta})}$。

两种模型的概率函数都是 $\mathbf{x}_i^\top \pmb{\beta}$ 的单调递增函数，其曲线呈S形，能自动保证预测概率落在0到1之间。Probit模型和Logit模型的估计结果通常非常接近。它们的差异主要在于逻辑分布的尾部略厚于正态分布，但这在实证中很少导致实质性区别。模型选择常取决于学术传统或软件实现的便利性。

### 5.1.4 估计与解释

由于潜变量 $y_i^*$ 不可观测，二元选择模型通常采用**极大似然法**进行估计。对于样本量为 $N$ 的数据，似然函数为： $$
L(\pmb{\beta}) = \prod_{i: y_i=1} P(y_i=1|\mathbf{x}_i) \cdot \prod_{i: y_i=0} [1 - P(y_i=1|\mathbf{x}_i)]
$$

对似然函数取对数后，通过数值优化方法求解使对数似然函数最大的参数估计值 $\hat{\pmb{\beta}}$。

参数 $\pmb{\beta}$ 的估计值**不能直接解释为边际效应**。以Probit模型为例，第 $j$ 个解释变量 $x_{ij}$ 对选择概率的边际效应为： $$
\frac{\partial P(y_i=1|\mathbf{x}_i)}{\partial x_{ij}} = \phi(\mathbf{x}_i^\top \pmb{\beta}) \beta_j
$$ 其中 $\phi(\cdot)$ 是标准正态概率密度函数。该边际效应**不是常数**，它依赖于所有解释变量在 $\mathbf{x}_i$ 处的取值。因此，报告边际效应时，通常需要计算在解释变量样本均值处的值，或计算每个观测个体的边际效应后再求样本平均。

## 5.2 多元选择模型

当决策者面临两个以上的离散选项时，需要使用多元选择模型。根据选项之间是否具有自然的排序，可以分为**无序选择模型**和**有序选择模型**。本节讨论无序选择模型。

### 5.2.1 多项Logit模型

**多项Logit模型**是最常用的无序选择模型。设个体 $i$ 在 $J+1$ 个选项（编号为 `0, 1, ..., J`）中选择，以选项 `0` 为参照基准。个体选择选项 $j$ 的概率为： $$
P(y_i = j | \mathbf{x}_i) = \frac{\exp(\mathbf{x}_i^\top \pmb{\beta}_j)}{1 + \sum_{k=1}^{J} \exp(\mathbf{x}_i^\top \pmb{\beta}_k)}, \quad j=1,\ldots,J
$$ 以及 $P(y_i = 0 | \mathbf{x}_i) = \frac{1}{1 + \sum_{k=1}^{J} \exp(\mathbf{x}_i^\top \pmb{\beta}_k)}$。

该模型的一个关键性质是**无关选项的独立性**：任意两个选项的选择概率之比仅与这两个选项的特性有关，与其他选项无关。这一性质在某些情境下可能构成限制。

### 5.2.2 多项Probit模型及其他模型

为克服IIA性质的限制，可采用**多项Probit模型**。该模型假设与各选项相关的随机误差项服从多元正态分布。由于其似然函数涉及高维数值积分，计算较为复杂，但在计算能力提升和模拟方法发展的背景下，其应用正逐渐增加。

此外，还有**嵌套Logit模型**和**混合Logit模型**等，它们通过引入更灵活的误差相关结构，来建模选项之间可能存在的相关性。

## 5.3 排序选择模型

当因变量的离散类别之间存在**内在的顺序**时，例如调查问卷中的满意度（非常不满意、不满意、一般、满意、非常满意）、信用评级或疾病严重程度分级，则应使用排序选择模型。

### 5.4.1 模型设定

排序选择模型同样基于潜变量框架： $$
y_i^* = \mathbf{x}_i^\top \pmb{\beta} + \varepsilon_i
$$ 所观测到的有序结果 $y_i$ 由潜变量 $y_i^*$ 穿越一系列递增的**门槛值** $\mu_1 < \mu_2 < \cdots < \mu_{J-1}$ 决定： $$
y_i =
\begin{cases} 
0, & \text{if } y_i^* \le \mu_1 \\
1, & \text{if } \mu_1 < y_i^* \le \mu_2 \\
\vdots \\
J-1, & \text{if } y_i^* > \mu_{J-1}
\end{cases}
$$ 其中，为了模型识别，通常将常数项设为零，并设定 $\mu_1$（或 $\mu_0$ 为 `-∞`， $\mu_J$ 为 `+∞`）。

### 5.4.2 有序Probit与有序Logit

根据扰动项 $\varepsilon_i$ 的分布假设，可得到两种主要模型： \* **有序Probit模型**：假设 $\varepsilon_i \sim N(0, 1)$。 \* **有序Logit模型**：假设 $\varepsilon_i$ 服从逻辑分布。

个体 $i$ 选择类别 $j$ 的概率为： $$
\begin{aligned}
P(y_i = j | \mathbf{x}_i) &= P(\mu_{j} < y_i^* \le \mu_{j+1}) \\
&= F(\mu_{j+1} - \mathbf{x}_i^\top \pmb{\beta}) - F(\mu_j - \mathbf{x}_i^\top \pmb{\beta})
\end{aligned}
$$ 其中 $F(\cdot)$ 是标准正态或逻辑分布的累积分布函数。

解释变量 $\mathbf{x}_i$ 对处于特定类别 $j$ 的概率的边际效应，其符号并不确定，需要进行计算。$\pmb{\beta}$ 系数的符号可以解释为对潜变量 $y_i^*$ 的影响方向。

## 5.4 计数数据模型

当因变量是**非负整数计数**时，例如一个家庭在一年内就医的次数、一家企业申请的专利数量，或一个区域发生的交通事故数，需要使用计数数据模型。

### 5.4.1 泊松回归模型

**泊松回归**是计数模型的基础。设 $y_i$ 给定 $\mathbf{x}_i$ 的条件分布为泊松分布： $$
P(y_i | \mathbf{x}_i) = \frac{e^{-\lambda_i} \lambda_i^{y_i}}{y_i!}, \quad y_i = 0, 1, 2, \ldots
$$ 其中，条件均值（即发生率的期望）被设定为指数形式，以确保其为正： $$
E(y_i | \mathbf{x}_i) = \lambda_i = \exp(\mathbf{x}_i^\top \pmb{\beta})
$$ 泊松分布的一个重要性质是**等离散性**，即条件均值等于条件方差：$E(y_i | \mathbf{x}_i) = \text{Var}(y_i | \mathbf{x}_i) = \lambda_i$。

### 5.4.1 负二项回归模型

在实际数据中，方差常常大于均值，这种现象称为**过度离散**。忽视过度离散会导致标准误被低估。**负二项回归**模型通过引入一个额外的随机成分来放松等离散假设，其条件方差被设定为 $$ \text{Var}(y_i | \mathbf{x}_i) = \lambda_i + \alpha \lambda_i^2 $$，其中 $\alpha > 0$ 是衡量过度离散程度的参数。当 $\alpha = 0$ 时，负二项回归即退化为泊松回归。

此外，对于数据中零值过多的情形，还有**零膨胀泊松模型**和**零膨胀负二项模型**等专门应对零值堆积问题的扩展模型。

## 5.5 受限因变量模型

当因变量的观测值由于数据收集过程而受到限制时，就需要用到受限因变量模型。主要分为两类：**截取**和**断尾**。

### 5.5.1 截取回归模型

在截取情况下，部分因变量的真实值无法被观测到，但我们知道它们是否被截取以及截取的界限。最经典的模型是**Tobit模型**，由James Tobin提出，常用于分析诸如家庭耐用消费品支出（有大量零值）等数据。

标准Tobit模型（Type I）设定如下： $$
\begin{aligned}
y_i^* &= \mathbf{x}_i^\top \pmb{\beta} + u_i, \quad u_i | \mathbf{x}_i \sim N(0, \sigma^2) \\
y_i &= \max(0, y_i^*)
\end{aligned}
$$ 我们观测到的是 $y_i$，而非 $y_i^*$。对于 $y_i > 0$ 的观测，其条件分布是断尾正态分布；对于 $y_i = 0$ 的观测，我们仅知道 $y_i^* \le 0$。

该模型可用极大似然法估计，其对数似然函数由两部分构成：对应于 $y_i=0$ 观测的概率部分，和对应于 $y_i>0$ 观测的密度部分。Tobit模型的一个关键特征是，解释变量 $\mathbf{x}_i$ 同时对决定 $y_i^*$ 是否大于0的概率（即“选择方程”）和给定 $y_i^*>0$ 时 $y_i^*$ 的水平（即“水平方程”）产生影响，且两个效应的系数比例是固定的，这有时可能构成限制。

**两阶段估计**和**工具变量Tobit模型**也被发展出来，以处理内生解释变量等问题。

### 5.5.2 断尾回归模型

在断尾情况下，部分观测值被完全排除在样本之外，既不知道其存在，也不知道其解释变量的值。例如，只对收入高于某个门槛的家庭进行调查。

若断尾规则为 $y_i^* > c$，则我们观测到的 $y_i$ 的条件分布为： $$
f(y_i | y_i > c, \mathbf{x}_i) = \frac{f(y_i^* | \mathbf{x}_i)}{P(y_i^* > c | \mathbf{x}_i)}, \quad y_i > c
$$ 其中 $f(y_i^* | \mathbf{x}_i)$ 是 $y_i^*$ 的原始条件密度函数。忽略断尾而直接使用OLS估计，会导致参数估计有偏。

### 5.5.3 样本选择模型

样本选择模型（Heckman模型）处理的是更一般的选择性问题：是否进入样本（选择方程）与关心的结果变量（结果方程）由两个虽有联系但不同的机制决定。

其经典设定如下： $$
\begin{aligned}
\text{选择方程:} & \quad s_i^* = \mathbf{z}_i^\top \pmb{\gamma} + v_i, \quad s_i = \mathbf{1}[s_i^* > 0] \\
\text{结果方程:} & \quad y_i^* = \mathbf{x}_i^\top \pmb{\beta} + u_i \\
\text{观测规则:} & \quad y_i = y_i^* \text{ 当且仅当 } s_i = 1; \text{ 否则 } y_i \text{ 缺失}
\end{aligned}
$$ 其中 $(u_i, v_i)$ 假设服从二元正态分布。如果误差 $u_i$ 和 $v_i$ 相关，那么仅对可观测样本进行OLS回归就会导致**样本选择偏差**。

Heckman提出了一个广为使用的两阶段纠正方法： 1. 利用全部样本，用Probit模型估计选择方程，得到逆米尔斯比 $\hat{\lambda}_i = \phi(\mathbf{z}_i^\top \hat{\pmb{\gamma}}) / \Phi(\mathbf{z}_i^\top \hat{\pmb{\gamma}})$。 2. 在可观测子样本中，将 $\hat{\lambda}_i$ 作为额外控制变量加入结果方程进行OLS回归，即估计 $y_i = \mathbf{x}_i^\top \pmb{\beta} + \rho \sigma_u \hat{\lambda}_i + \eta_i$。其中 $\rho \sigma_u$ 的系数显著性检验了选择偏差的存在性。

## 5.6 模型设定检验与前沿议题

### 5.6.1 对模型假设的检验

离散与受限因变量模型大多依赖于较强的分布假设（如正态性、逻辑分布）和函数形式假设（如线性指数）。近年来，针对这些假设的检验方法不断发展。

例如，对于Tobit模型，有文献系统性地发展了对其核心识别假设（线性指数、潜在误差的正态性、外生性）的**可检验等式**，并构建了相应的检验程序。还有研究专注于检验Tobit模型中的正态性假设，或将其与更灵活的两部分模型进行对比的设定检验。

当关键假设被拒绝时，研究者可以考虑使用对分布假设更稳健的半参数或非参数估计方法，或者转向基于较弱假设的**部分识别**分析框架。

### 5.6.2 动态模型与面板数据扩展

在面板数据背景下，离散和受限因变量模型可以纳入个体效应（固定效应或随机效应）以控制不随时间变化的异质性。更进一步，**动态模型**（包含因变量滞后项）被用来研究状态依赖性和调整成本，例如上一期的就业状态如何影响当期的就业概率。

这些扩展模型在估计上更具挑战，但为分析经济行为的持续性和动态变化提供了有力工具。

## 5.7 案例分析

本章节旨在提供一个或多个综合性的实证研究框架示例，展示如何根据研究问题与数据类型，从本章介绍的模型库中选择适当的模型，并完成从模型设定、估计、假设检验到结果解释的全过程。例如，可以分析影响个人高等教育选择（二元/多项选择）的因素，或研究家庭慈善捐款数额（截取数据）的决定因素。具体案例内容此处从略。

## 本章总结

本章系统介绍了当因变量为离散或受限变量时的一整套计量经济学建模方法。我们从二元选择的基础模型（Probit/Logit）出发，逐步扩展到多元无序选择、有序选择以及计数数据模型。最后，探讨了处理数据截取、断尾和样本选择问题的受限因变量模型。

这些模型的共同核心是**基于潜变量或直接设定非线性的条件期望函数**，并通常依赖**最大似然估计**。在解释估计结果时，必须谨慎，因为系数通常不代表简单的边际效应，边际效应本身也常常依赖于其他变量的取值。

在选择模型时，**首要准则是因变量的数据类型和经济问题的实质**（有无序、是否有序、是否计数、是否受限）。同时，需要意识到各种经典模型背后的假设，并利用不断发展成熟的检验方法对模型设定进行诊断。当数据和方法允许时，考虑使用更稳健的估计量或探索面板数据、动态模型等扩展形式，能使实证分析更为深入和可靠。

掌握本章内容，将使研究者能够更恰当地处理微观实证研究中广泛存在的离散和受限因变量问题，从而得出更有效的经验证据和经济解释。