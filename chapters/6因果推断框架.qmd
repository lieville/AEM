---
title: "6 因果推断框架"
format: 
  html:
    mermaid:
      theme: forest
      backgroundColor: transparent
editor: visual
---

## 本章导读

> **"相关性不是因果性"**——这一原则构成了现代计量经济学的基石。在前几章中，我们学习了如何使用回归模型描述变量间的相关关系。从本章开始，我们将回答一个更根本的问题：**如何从观测数据中识别因果关系？** 本章将建立因果推断的基本理论框架，为后续章节的具体方法奠定基础。

在经济学研究中，我们经常关心诸如"教育对收入的影响"、"最低工资对就业的影响"、"货币政策对经济增长的影响"等问题。这些问题的本质都是**因果问题**——我们想知道如果改变某个变量（处理变量），结果变量会发生怎样的变化。然而，从观测数据中识别因果关系面临着**选择偏差**、**内生性**等根本挑战。本章将系统介绍因果推断的理论框架，为理解后续章节的具体方法提供坚实基础。

```{mermaid}
flowchart TD
    A[随机对照实验 RCT<br/>金标准] --> B{现实约束：无法实验}
    B --> C[第一代：OLS/回归控制<br/>假设：条件独立性]
    C --> D{假设违背：未观测混杂}
    
    D --> E[第二代：自然实验方法]
    E --> F[工具变量法 IV<br/>假设：排他性约束]
    E --> G[断点回归 RD<br/>假设：连续性]
    E --> H[双重差分法 DID<br/>假设：平行趋势]
    
    D --> I[第三代：构造对照组]
    I --> J[倾向得分匹配 PSM<br/>假设：强可忽略性]
    I --> K[合成控制法<br/>假设：可合成性]
    
    D --> L[第四代：面板数据方法]
    L --> M[固定效应模型 FE<br/>假设：时不变混杂]
    
    F & G & H & J & K & M --> N[方法融合与稳健性检验]
```

## 6.1 从相关到因果：问题的根本转变

### 6.1.1 相关性分析的局限

考虑以下三个经典例子：

1.  **冰淇淋销量与溺水人数**：两者呈现正相关，但这是因果关系吗？实际上，两者都受到季节（夏季）的影响。
2.  **教育年限与收入**：受教育程度高的人通常收入更高，但这是因为教育本身提高了生产率，还是因为能力高的人既倾向于接受更多教育又容易获得高收入？
3.  **班级规模与学生成绩**：小班教学的学生成绩更好，但这是因为班级规模的影响，还是因为资源丰富的学校既倾向于小班化又提供更好的教学条件？

这些例子揭示了相关性与因果性的根本区别。**相关性**描述的是变量间的统计关联，而**因果性**描述的是一个变量的变化如何导致另一个变量的变化。

### 6.1.2 经济研究中的因果问题类型

经济学中的因果问题主要分为三类：

1.  **政策干预效果评估**：评估某项政策（如税收改革、教育补贴）对经济结果的影响。
2.  **行为反应机制分析**：分析个体或企业对激励变化的反应。
3.  **市场均衡效应识别**：识别市场结构变化对均衡价格和数量的影响。

## 6.2 潜在结果框架：因果推断的统一语言

### 6.2.1 基本设定与符号体系

潜在结果框架（Potential Outcomes Framework），又称Rubin因果模型，由Donald Rubin等人发展，已成为现代因果推断的标准语言。

对于每个个体$i$，我们定义：

-   **处理状态**：$T_i \in \{0, 1\}$，其中$T_i = 1$表示接受处理（如参加培训项目），$T_i = 0$表示未接受处理（控制组）
-   **潜在结果**：$Y_i(1)$表示如果个体$i$接受处理时的结果，$Y_i(0)$表示如果个体$i$未接受处理时的结果

观测到的结果可以表示为： $$
Y_i^{\text{obs}} = T_i Y_i(1) + (1 - T_i) Y_i(0)
$$

### 6.2.2 因果推断的"根本问题"

因果推断面临的根本问题是：**对于同一个体，我们只能观测到一种潜在结果**。如果个体接受了处理（$T_i = 1$），我们观测到$Y_i(1)$但无法观测$Y_i(0)$；如果个体未接受处理（$T_i = 0$），我们观测到$Y_i(0)$但无法观测$Y_i(1)$。这个反事实结果（Counterfactual Outcome）的不可观测性被称为**因果推断的根本问题**。

### 6.2.3 主要因果参数

由于个体处理效应$\tau_i = Y_i(1) - Y_i(0)$不可观测，我们转向估计群体层面的平均效应：

1.  **平均处理效应**（Average Treatment Effect, ATE）： $$
    \tau_{\text{ATE}} = \mathbb{E}[Y_i(1) - Y_i(0)]
    $$

2.  **处理组的平均处理效应**（Average Treatment Effect on the Treated, ATT）： $$
    \tau_{\text{ATT}} = \mathbb{E}[Y_i(1) - Y_i(0) | T_i = 1]
    $$

3.  **控制组的平均处理效应**（Average Treatment Effect on the Controls, ATC）： $$
    \tau_{\text{ATC}} = \mathbb{E}[Y_i(1) - Y_i(0) | T_i = 0]
    $$

## 6.3 稳定性假设与选择偏差

### 6.3.1 SUTVA假设及其经济含义

稳定单位处理值假设（Stable Unit Treatment Value Assumption, SUTVA）包含两个部分：

1.  **无干扰性**：个体$i$的结果不受其他个体处理状态的影响。 $$
    Y_i(T_1, T_2, ..., T_n) = Y_i(T_i)
    $$

2.  **处理一致性**：同一处理对所有个体具有相同的含义和效果。

在经济学中，SUTVA的违背常见于： - **溢出效应**：一个地区的基础设施投资可能影响邻近地区 - **一般均衡效应**：大规模政策可能改变市场价格和资源配置 - **网络效应**：个体的行为可能受到社会网络的影响

### 6.3.2 选择偏差：因果推断的核心障碍

选择偏差源于处理组和对照组在潜在结果上的系统性差异。观测到的均值差异可以分解为： $$
\mathbb{E}[Y_i^{\text{obs}} | T_i = 1] - \mathbb{E}[Y_i^{\text{obs}} | T_i = 0] = \tau_{\text{ATT}} + \text{选择偏差}
$$

其中选择偏差为： $$
\text{选择偏差} = \mathbb{E}[Y_i(0) | T_i = 1] - \mathbb{E}[Y_i(0) | T_i = 0]
$$

当处理组个体即使不接受处理，其潜在结果$Y_i(0)$也不同于对照组时，就产生了选择偏差。

### 6.3.3 选择偏差的类型与来源

| 偏差类型 | 来源 | 经济实例 |
|---------------------------|------------------|---------------------------|
| **可观测特征偏差** | 处理组和对照组在可观测特征上的差异 | 高收入者更可能参加培训项目 |
| **不可观测特征偏差** | 处理组和对照组在不可观测特征上的差异 | 能力高的人既倾向于接受教育又容易获得高收入 |
| **自选择偏差** | 个体基于预期结果选择是否接受处理 | 预期培训效果好的个体更可能参加培训 |
| **制度性选择偏差** | 制度规则导致的选择 | 贫困线以下的家庭自动获得福利 |

## 6.4 随机化实验：选择偏差的"黄金标准解"

### 6.4.1 随机化的理论保障

随机化实验通过随机分配处理状态，确保处理组和对照组在**所有特征**（包括可观测和不可观测特征）上具有可比性： $$
T_i \perp \{Y_i(1), Y_i(0), X_i, U_i\}
$$

其中$X_i$表示可观测特征，$U_i$表示不可观测特征。这一独立性意味着： $$
\mathbb{E}[Y_i(0) | T_i = 1] = \mathbb{E}[Y_i(0) | T_i = 0]
$$

因此，选择偏差为零，ATE的简单均值差估计量是一致的： $$
\hat{\tau}_{\text{ATE}} = \frac{1}{n_1} \sum_{i: T_i = 1} Y_i - \frac{1}{n_0} \sum_{i: T_i = 0} Y_i
$$

### 6.4.2 经济学实验的设计类型

1.  **实验室实验**：在控制环境下进行，适用于检验理论机制。
2.  **田野实验**：在自然环境中进行，具有更高的外部有效性。
3.  **自然实验**：利用外生政策变化或自然事件作为处理分配。

### 6.4.3 随机化实验的局限与挑战

1.  **外部有效性**：实验环境可能无法反映真实世界
2.  **伦理约束**：某些处理（如有害物质）不能随机分配
3.  **成本高昂**：大规模实验需要大量资源
4.  **依从性问题**：实验对象可能不遵守分配
5.  **处理效应异质性**：简单均值差可能掩盖效应异质性

## 6.5 非混杂性：观测研究的识别基石

### 6.5.1 条件独立性的形式化表达

当随机化不可行时，我们需要依赖观测数据。**强可忽略性假设**（Strong Ignorability）是观测研究中因果识别的基础： $$
(Y_i(1), Y_i(0)) \perp T_i | X_i
$$

这一假设要求：在给定协变量$X_i$的条件下，处理分配$T_i$与潜在结果独立。此外，还需要**共同支持条件**： $$
0 < \Pr(T_i = 1 | X_i = x) < 1 \quad \text{对于所有} \ x
$$

### 6.5.2 非混杂性的经济学解释

非混杂性假设意味着：所有同时影响处理选择和结果的变量都已包含在$X_i$中。在给定$X_i$的层内，处理分配如同随机。

考虑教育对收入的影响例子： - 如果能力既影响教育选择又影响收入，且能力可观测，则控制能力后，非混杂性可能成立。 - 如果能力不可观测，则非混杂性被违背，估计将有偏。

### 6.5.3 假设的实践评估

在实践中，我们需要：

1.  **基于经济理论**选择控制变量
2.  **检验平衡性**：处理组和对照组在$X_i$上是否平衡
3.  **进行敏感性分析**：评估结论对未观测混杂的稳健性

## 6.6 内生性：计量经济学的经典难题

### 6.6.1 内生性的三个来源

内生性指解释变量与误差项相关，是因果推断的主要障碍：

1.  **遗漏变量**：未观测的混杂变量$U_i$既影响$T_i$又影响$Y_i$
2.  **反向因果**：$Y_i$影响$T_i$，同时$T_i$影响$Y_i$
3.  **测量误差**：$T_i$的测量存在误差

### 6.6.2 内生性的统计后果

考虑线性模型： $$
Y_i = \alpha + \beta T_i + \gamma' X_i + \epsilon_i
$$

如果$\mathbb{E}[\epsilon_i | T_i, X_i] \neq 0$，则：

1.  OLS估计量$\hat{\beta}$有偏且不一致
2.  标准误差估计有偏
3.  假设检验失效
4.  预测和政策建议不可靠

### 6.6.3 内生性与非混杂性的关系

内生性和非混杂性是同一问题的两种表述。非混杂性成立意味着无遗漏变量问题，从而消除了一种内生性来源。具体关系如下：

```{mermaid}
flowchart TD
    A[内生性存在] <--> B[非混杂性违背]
    C[遗漏变量] --> A
    D[反向因果] --> A
    E[测量误差] --> A
    
    F[非混杂性成立] --> G[内生性部分消除<br/>仅解决遗漏变量]
    H[条件独立性] --> F
```

## 6.7 线性回归的因果解释条件

### 6.7.1 随机化实验下的线性回归

在随机化实验中，即使是最简单的线性回归也能提供无偏的因果估计： $$
Y_i = \alpha + \beta T_i + \epsilon_i
$$

随机化保证$\mathbb{E}[\epsilon_i | T_i] = 0$，因此$\hat{\beta} = \widehat{\text{ATE}}$。

### 6.7.2 满足非混杂性条件的线性回归

当非混杂性成立时，包含所有混杂变量的线性回归可以提供无偏估计： $$
Y_i = \alpha + \beta T_i + \gamma' X_i + \epsilon_i
$$

条件独立性$(Y_i(1), Y_i(0)) \perp T_i | X_i$保证了$\mathbb{E}[\epsilon_i | T_i, X_i] = 0$，因此$\hat{\beta} = \widehat{\text{ATE}}$。

### 6.7.3 回归控制法：扩展与应用

**回归控制法**（Regression Adjustment）是线性回归在因果推断中的直接应用。当非混杂性成立时，通过控制所有混杂变量$X_i$，我们可以获得处理效应的无偏估计。

在实践中，我们需要：

1.  正确设定函数形式（考虑非线性、交互项）
2.  检查共同支持条件
3.  进行模型诊断和稳健性检验

### 6.7.4 遗漏变量偏差的定量分析

考虑真实数据生成过程为： $$
Y_i = \alpha + \beta T_i + \gamma X_i + \delta U_i + \eta_i
$$

但如果我们只控制$X_i$，估计模型为： $$
Y_i = \tilde{\alpha} + \tilde{\beta} T_i + \tilde{\gamma} X_i + \tilde{\eta}_i
$$

那么$\tilde{\beta}$的概率极限为： $$
\text{plim} \ \tilde{\beta} = \beta + \delta \frac{\text{Cov}(T_i, U_i|X_i)}{\text{Var}(T_i|X_i)}
$$

偏差的大小取决于： 1. $U_i$对$Y_i$的影响强度（$\delta$） 2. $T_i$和$U_i$在给定$X_i$下的相关性

## 6.8 因果推断方法分类框架

### 6.8.1 基于识别策略的分类体系

现代因果推断方法可以根据其核心识别策略分为五大类：

```{mermaid}
flowchart TD
    A[因果推断方法] --> B[实验方法]
    A --> C[准实验方法]
    A --> D[基于可忽略性方法]
    A --> E[面板数据方法]
    A --> F[合成控制方法]
    
    B --> G[随机对照实验]
    
    C --> H[工具变量法]
    C --> I[断点回归]
    
    D --> J[回归控制法]
    D --> K[匹配方法]
    D --> L[倾向得分加权]
    
    E --> M[固定效应模型]
    E --> N[双重差分法]
    E --> O[事件研究法]
    
    F --> P[经典合成控制]
    F --> Q[广义合成控制]
    
    G & H & I & J & K & L & M & N & O & P & Q --> R[因果效应估计]
```

### 6.8.2 各类方法的比较分析

| 方法类别         | 代表方法     | 关键假设     | 估计参数 | 数据要求   | 适用场景       |
|------------|------------|------------|------------|------------|------------|
| **实验方法**     | 随机对照实验 | 完美随机化   | ATE      | 实验数据   | 可实施随机化   |
| **准实验方法**   | 工具变量法   | 外生工具变量 | LATE     | 有效工具   | 有自然实验     |
| **准实验方法**   | 断点回归     | 连续性假设   | 局部ATE  | 运行变量   | 有清晰断点     |
| **可忽略性方法** | 回归控制法   | 条件独立性   | ATE      | 丰富协变量 | 可测所有混杂   |
| **可忽略性方法** | 倾向得分匹配 | 强可忽略性   | ATT      | 平衡协变量 | 对照组丰富     |
| **面板数据方法** | 固定效应模型 | 时不变混杂   | ATE      | 面板数据   | 个体异质性     |
| **面板数据方法** | 双重差分法   | 平行趋势     | ATT      | 面板数据   | 政策评估       |
| **合成控制方法** | 合成控制法   | 可合成性     | ATT      | 时间序列   | 小样本政策评估 |

### 6.8.3 固定效应模型：处理时不变混杂

#### 6.8.3.1 面板数据与因果识别的优势

固定效应模型是处理观测数据中未观测混杂的重要方法，特别适用于**面板数据**（Panel Data）或**追踪数据**（Longitudinal Data）。面板数据的核心特征是每个个体（如个人、企业、地区）在多个时间点上被观测，这为我们处理因果推断问题提供了独特优势。

**面板数据结构**：
$$
\{Y_{it}, T_{it}, X_{it}\}, \quad i = 1, ..., N; \quad t = 1, ..., T
$$
其中：
- $i$：个体标识（如个人、企业、城市）
- $t$：时间标识（如年份、季度）
- $Y_{it}$：个体$i$在时间$t$的结果变量
- $T_{it}$：个体$i$在时间$t$的处理状态（0或1）
- $X_{it}$：个体$i$在时间$t$的可观测协变量

#### 6.8.3.2 固定效应模型的因果识别机制


考虑以下固定效应模型：
$$
Y_{it} = \alpha_i + \lambda_t + \beta T_{it} + \gamma' X_{it} + \epsilon_{it}
$$

其中：
- $\alpha_i$：**个体固定效应**，捕捉所有不随时间变化的个体特征
- $\lambda_t$：**时间固定效应**，捕捉所有个体共同经历的时间趋势
- $\beta$：处理效应，是我们关心的因果参数
- $\epsilon_{it}$：时变冲击，满足$\mathbb{E}[\epsilon_{it} | T_{it}, X_{it}, \alpha_i, \lambda_t] = 0$

** 固定效应如何解决未观测混杂**

固定效应模型的威力在于$\alpha_i$可以吸收**所有不随时间变化的未观测混杂**。考虑一个具体例子：

**研究问题**：分析员工培训（$T_{it}$）对工资（$Y_{it}$）的因果效应。

**未观测混杂**：员工的能力（$U_i$）既影响是否参加培训，又影响工资水平。能力通常不可直接观测或难以准确测量。

**传统截面数据分析的问题**：
如果使用截面数据，我们需要控制能力$U_i$。但由于$U_i$不可观测，导致遗漏变量偏差：
$$
\text{plim} \ \hat{\beta}_{OLS} = \beta + \frac{\text{Cov}(T_i, U_i)}{\text{Var}(T_i)}
$$

**固定效应模型的解决方案**：
在面板数据中，我们可以将能力分解为：
$$
\text{能力}_i = \underbrace{\alpha_i}_{\text{时不变部分}} + \underbrace{v_{it}}_{\text{时变部分}}
$$

固定效应模型通过$\alpha_i$吸收了时不变的能力部分。只要能力的大部分变异是时不变的，固定效应模型就能有效消除能力混杂带来的偏差。


固定效应模型的有效性依赖于以下关键假设：

1. 严格外生性假设：
   $$
   \mathbb{E}[\epsilon_{it} | T_{i1}, ..., T_{iT}, X_{i1}, ..., X_{iT}, \alpha_i, \lambda_t] = 0
   $$
   这意味着给定个体固定效应和时间固定效应后，处理变量$T_{it}$和协变量$X_{it}$与误差项$\epsilon_{it}$不相关。

2. 未观测混杂的时不变性：
   所有未观测的混杂变量$U_i$必须满足：
   $$
   U_i = \alpha_i + v_{it}, \quad \text{其中} \ \alpha_i \ \text{为时不变部分}
   $$
   固定效应只能消除$\alpha_i$部分，无法处理时变部分$v_{it}$。

3. 处理效应同质性（或已知的异质性模式）：
   $$
   Y_{it}(1) - Y_{it}(0) = \beta \quad \text{对所有} \ i,t
   $$
   或至少处理效应的异质性模式是已知且可建模的。

#### 6.8.3.3 估计方法与实现

** 组内估计量（Within Estimator）**

固定效应模型最常用的估计方法是组内估计量，通过消除个体固定效应进行估计：

第一步：计算个体均值
$$
\bar{Y}_i = \frac{1}{T} \sum_{t=1}^T Y_{it}, \quad \bar{T}_i = \frac{1}{T} \sum_{t=1}^T T_{it}, \quad \bar{X}_i = \frac{1}{T} \sum_{t=1}^T X_{it}
$$

第二步：进行组内变换
$$
\tilde{Y}_{it} = Y_{it} - \bar{Y}_i, \quad \tilde{T}_{it} = T_{it} - \bar{T}_i, \quad \tilde{X}_{it} = X_{it} - \bar{X}_i
$$

第三步：估计变换后的模型
$$
\tilde{Y}_{it} = \lambda_t + \beta \tilde{T}_{it} + \gamma' \tilde{X}_{it} + \tilde{\epsilon}_{it}
$$

其中时间固定效应$\lambda_t$可以通过加入时间虚拟变量或进行时间均值差分来消除。

**一阶差分估计量（First-Difference Estimator）**

另一种常用方法是一阶差分法，特别适用于$T=2$的情况：

差分变换:
$$
\Delta Y_i = Y_{i2} - Y_{i1}, \quad \Delta T_i = T_{i2} - T_{i1}, \quad \Delta X_i = X_{i2} - X_{i1}
$$

估计模型：
$$
\Delta Y_i = \beta \Delta T_i + \gamma' \Delta X_i + \Delta \epsilon_i
$$

一阶差分法同样消除了个体固定效应$\alpha_i$。

**两种方法的比较**

| 方法 | 优点 | 缺点 | 适用场景 |
|------|------|------|----------|
| **组内估计量** | 效率高（使用所有变异） | 需要严格外生性 | 平衡面板，$T \geq 2$ |
| **一阶差分** | 对序列相关更稳健 | 损失信息，效率较低 | $T=2$或担心严格外生性 |

#### 6.8.3.4 固定效应模型的因果解释

**处理效应的识别来源**

在固定效应模型中，处理效应$\beta$的识别来源于**个体内部**处理状态的变化。具体来说：

1. **处理组个体**：通过比较同一个体在处理前后的变化
2. **处理状态变化个体**：通过比较个体从未处理到处理（或相反）的变化
3. **始终处理/未处理个体**：不贡献于$\beta$的识别（除非有处理效应异质性）

这种识别策略被称为"**利用个体内部变异**"，其优势在于可以有效控制所有时不变的个体异质性。

图示说明：固定效应模型的识别机制

```{mermaid}
flowchart TD
    A[个体i的工资轨迹] --> B{处理状态变化}
    B --> C[处理前时期<br/>T_it=0]
    B --> D[处理后时期<br/>T_it=1]
    
    C --> E[观测结果: Y_it0]
    D --> F[观测结果: Y_it1]
    
    E --> G[反事实构造<br/>利用个体自身趋势]
    F --> H[实际结果]
    
    G --> I[个体内差分: ΔY_i = Y_it1 - Y_it0]
    H --> I
    
    I --> J[因果效应估计<br/>β = E[ΔY_i | ΔT_i=1] - E[ΔY_i | ΔT_i=0]]
```

**数学证明：固定效应模型的无偏性**

假设真实数据生成过程为：
$$
Y_{it} = \alpha_i + \lambda_t + \beta T_{it} + \theta' U_i + \gamma' X_{it} + \epsilon_{it}
$$
其中$U_i$为未观测的时不变混杂变量。

在组内变换后：
$$
\tilde{Y}_{it} = \lambda_t + \beta \tilde{T}_{it} + \gamma' \tilde{X}_{it} + \tilde{\epsilon}_{it}
$$

因为$\tilde{U}_i = U_i - \bar{U}_i = 0$，未观测混杂$U_i$被完全消除。只要$\mathbb{E}[\tilde{\epsilon}_{it} | \tilde{T}_{it}, \tilde{X}_{it}] = 0$，$\hat{\beta}$就是$\beta$的无偏估计量。



** 主要局限性**

1. **时变混杂问题**：固定效应只能消除时不变混杂，无法处理时变未观测混杂
2. **动态选择问题**：如果处理决策基于过去的冲击（$\epsilon_{i,t-1}$），严格外生性假设被违背
3. **处理效应异质性**：如果处理效应因人而异，固定效应估计量可能不是有意义的平均
4. **测量误差偏误**：组内变换可能放大测量误差的影响

**解决方案**

1. **滞后因变量模型**：控制滞后结果变量
   $$
   Y_{it} = \alpha_i + \lambda_t + \rho Y_{i,t-1} + \beta T_{it} + \gamma' X_{it} + \epsilon_{it}
   $$

2. **动态面板模型**：使用GMM方法估计
   $$
   Y_{it} = \alpha_i + \lambda_t + \rho Y_{i,t-1} + \beta T_{it} + \gamma' X_{it} + \epsilon_{it}
   $$

3. **事件研究法**：检验处理前后的动态效应
   $$
   Y_{it} = \alpha_i + \lambda_t + \sum_{k=-K}^{-1} \beta_k \cdot D_{i,t+k} + \sum_{k=0}^{L} \beta_k \cdot D_{i,t+k} + \gamma' X_{it} + \epsilon_{it}
   $$
   其中$D_{i,t+k}$是个体$i$在$t+k$期是否处于处理期的虚拟变量。


固定效应模型在以下情况下特别适用：

1. **面板数据可得**：每个个体有多个时间点的观测
2. **主要混杂时不变**：理论判断主要混杂变量不随时间变化
3. **处理状态变化**：个体处理状态随时间发生变化
4. **平行趋势假设**：在没有处理的情况下，处理组和对照组的趋势相同
### 6.8.4 合成控制法：小样本政策评估

合成控制法适用于处理单元较少（如一个州、一个国家）的政策评估问题：

**基本思想**：从未受处理的供体单元中构造一个"合成控制组"，使其在处理前的特征和结果轨迹与处理单元尽可能相似。

**优化问题**： $$
\min_{w} \left\| X_1 - \sum_{j=2}^{J+1} w_j X_j \right\|_V
\quad \text{s.t.} \quad w_j \geq 0, \sum_{j=2}^{J+1} w_j = 1
$$

其中$X_1$为处理单元的预处理特征向量，$X_j$为供体单元的特征向量，$V$为权重矩阵，$w_j$为供体单元的权重。

**处理效应估计**： $$
\hat{\tau}_{1t} = Y_{1t} - \sum_{j=2}^{J+1} \hat{w}_j Y_{jt}, \quad t > T_0
$$

其中$T_0$为处理发生的时间。

**关键假设**： 1. 供体池足够丰富，能够较好地拟合处理单元 2. 处理前拟合期足够长，能够捕捉趋势 3. 处理单元与合成控制组在处理前具有相似的特征和趋势

**推断方法**：排列检验（Placebo Test）

## 6.9 实证案例分析：最低工资的就业效应

### 6.9.1 研究背景与经典争议

最低工资政策对就业的影响是劳动经济学中的经典问题。传统理论预测，提高最低工资会减少就业，但实证证据并不一致。

### 6.9.2 Card和Krueger（1994）的自然实验

Card和Krueger利用新泽西州提高最低工资而相邻的宾夕法尼亚州未提高的自然实验，采用双重差分法估计最低工资对快餐业就业的影响。

### 6.9.3 研究设计与识别策略

1.  **处理组**：新泽西州的快餐店
2.  **对照组**：宾夕法尼亚州的快餐店
3.  **处理前后**：1992年2月（政策前）和1992年11月（政策后）
4.  **识别假设**：平行趋势假设——如果没有最低工资提高，两州的就业趋势相同

### 6.9.4 Stata操作演示（目录）

-   6.9.4.1 数据导入与清理
-   6.9.4.2 描述性统计分析
-   6.9.4.3 平行趋势检验
-   6.9.4.4 双重差分估计
-   6.9.4.5 稳健性检验
-   6.9.4.6 结果可视化

### 6.9.5 R操作演示（目录）

-   6.9.5.1 数据准备与探索
-   6.9.5.2 使用`did`包进行DID估计
-   6.9.5.3 事件研究法实现
-   6.9.5.4 敏感性分析
-   6.9.5.5 结果报告与可视化

## 本章总结

### 核心概念体系回顾

1.  **潜在结果框架**：定义了因果推断的基本语言和核心参数（ATE、ATT、ATC）
2.  **根本问题**：反事实结果的不可观测性是因果推断的根本障碍
3.  **选择偏差**：源于处理组和对照组在潜在结果上的系统性差异
4.  **SUTVA假设**：保证了处理效应的稳定性和可定义性
5.  **非混杂性**：观测研究中因果识别的核心假设
6.  **内生性**：计量经济学中的经典难题，有三个主要来源

### 方法体系梳理

因果推断方法可以根据其识别策略分为五大类：

1.  **实验方法**：随机化实验是因果识别的黄金标准
2.  **准实验方法**：利用自然实验或制度设计模拟随机化（IV、RD）
3.  **基于可忽略性方法**：通过控制所有混杂变量识别因果效应（回归控制、匹配）
4.  **面板数据方法**：利用时间维度消除时不变混杂（FE、DID）
5.  **合成控制方法**：为小样本政策评估提供解决方案

```{mermaid}
flowchart TD
    Start[研究问题] --> Q1{能否随机化？}
    Q1 -- 能 --> RCT[实施随机对照实验]
    Q1 -- 不能 --> Q2{有无清晰断点？}
    
    Q2 -- 有 --> RD[断点回归设计]
    Q2 -- 无 --> Q3{有无自然实验工具？}
    
    Q3 -- 有 --> IV[工具变量法<br/>检验：第一阶段F>10]
    Q3 -- 无 --> Q4{有无面板数据？}
    
    Q4 -- 有 --> Q5{处理时点是否统一？}
    Q4 -- 无 --> Q6{对照组是否明确？}
    
    Q5 -- 是 --> DID[双重差分法<br/>检验：平行趋势]
    Q5 -- 否 --> FE[固定效应模型<br/>检验：Hausman检验]
    
    Q6 -- 是 --> PSM[倾向得分匹配<br/>检验：平衡性]
    Q6 -- 否 --> SC[合成控制法<br/>检验：安慰剂检验]
    
    RCT & RD & IV & DID & FE & PSM & SC --> Val[多方法三角验证<br/>+ 敏感性分析]
```

### 关键理论关系

1.  **随机化的作用**： $$
    T_i \perp (Y_i(1), Y_i(0), X_i, U_i) \Rightarrow \text{无条件满足非混杂性}
    $$

2.  **线性回归的因果解释条件**：

    -   随机化条件下：$\mathbb{E}[\epsilon_i | T_i] = 0$
    -   非混杂性条件下：$\mathbb{E}[\epsilon_i | T_i, X_i] = 0$

3.  **固定效应模型的识别力量**： $$
    Y_{it} = \alpha_i + \beta T_{it} + \epsilon_{it} \Rightarrow \text{消除所有时不变混杂}
    $$

### 从理论到实践的桥梁

本章建立的框架为后续章节的具体方法提供了理论基础：

1.  **工具变量法（第7章）**：通过寻找外生工具解决内生性问题
2.  **断点回归（第8章）**：利用制度断点创造局部随机化
3.  **匹配方法（第9章）**：基于可忽略性假设构造可比样本
4.  **双重差分法（第10章）**：结合面板数据和平行趋势假设
5.  **合成控制法（第11章）**：小样本政策评估的专门方法

### 实践指导原则

在进行因果推断研究时，应遵循以下原则：

1.  **透明性**：明确陈述识别假设和可能违背
2.  **稳健性**：使用多种方法和设定检验结论的稳健性
3.  **诚实性**：承认研究的局限性，避免过度解读
4.  **理论指导**：基于经济理论选择变量和设定模型
5.  **敏感性分析**：评估结论对关键假设的敏感性

### 扩展思考

1.  **机器学习与因果推断**：如何将机器学习方法用于协变量选择和模型设定？
2.  **异质性处理效应**：如何识别和处理效应的异质性？
3.  **动态处理效应**：如何处理处理效应的动态变化？
4.  **溢出效应和一般均衡**：如何放宽SUTVA假设？

因果推断不仅是统计学和计量经济学的方法论，更是一种科学的思维方式。它要求我们从"是什么"（描述）转向"如果...会怎样"（因果），从被动观察转向主动思考。掌握这一框架，将使你能够更严谨地评估经济理论和政策效果，成为更优秀的经济学家。